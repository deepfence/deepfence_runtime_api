= Deepfence Runtime API v1.3


[[_overview]]
== Overview
Deepfence Runtime API provides programmatic control over Deepfence microservice securing your container and cloud deployments. The API abstracts away underlying infrastructure details like cloud provider, container distros, container orchestrator and type of deployment. This is one uniform API to manage and control security alerts, policies and response to alerts for microservices running anywhere i.e. managed pure greenfield container deployments or a mix of containers, VMs and serverless paradigms like AWS Fargate.


=== Version information
[%hardbreaks]
__Version__ : 1.3


=== Contents

* <<_authentication_resource,Authentication>>
* <<_enumerate_resource,Enumerate>>
* link:python-client/docs/StreamingAPI.md[Streaming API]
* <<_node_control_resource,Node Control>>
* <<_alert_management_resource,Alert Management>>
* <<_vulnerability_management_resource,Vulnerability Management>>
* <<_network_protection_policy_resource,Network Protection Policy>>
* <<_network_protection_policy_logs_resource,Network Protection Policy Logs>>
* <<_quarantine_protection_policy_resource,Quarantine Protection Policy>>
* <<_quarantine_protection_policy_logs_resource,Quarantine Protection Policy Logs>>
* <<_workload_protection_policy_resource,Workload Protection Policy>>


=== API Clients
- link:python-client/[Python]
- link:go-client/[Go]



=== Consumes

* `application/json`


=== Produces

* `application/json`




[[_paths]]
== Resources

[[_authentication_resource]]
=== Authentication

[[_authenticateapi]]
==== Authentication for API access
....
POST /deepfence/v1.3/users/auth
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Body**|**body** +
__optional__|JSON parameters.|<<_body,body>>
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Authentication successful.|No Content
|**400**|Bad request.|No Content
|**404**|API key not found.|No Content
|===


===== Produces

* `application/json`


===== Example HTTP response

====== Response 200
[source,json]
----
{
  "data": {
    "access_token": "",
    "refresh_token": "",
  },
  "error": null,
  "success": true
}
----


====== Response 400
[source,json]
----
{
  "data": null,
  "error": {
    "message": "api_key is required"
  },
  "success": false
}
----


====== Response 404
[source,json]
----
{
  "data": null,
  "error": {
    "message": "user with api_key aaaaa not found"
  },
  "success": false
}
----


[[_getuserdetails]]
==== User details.
....
GET /deepfence/v1.3/users/me
....


===== Description
Permission: ALL


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success.|<<_inline_response_200,inline_response_200>>
|**400**|Bad request.|No Content
|**404**|User not found.|No Content
|===


===== Produces

* `application/json`


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


===== Example HTTP response

====== Response 200
[source,json]
----
{
  "data" : "{}",
  "success" : true,
  "error" : "error"
}
----


[[_refreshjwttoken]]
==== Generate a new access token using refresh token
....
POST /deepfence/v1.3/users/refresh/token
....


===== Description
Generate a new access token using refresh token. Usage (In header): Authorization: Bearer <refresh_token>


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Login successful.|No Content
|**400**|Bad request|No Content
|**404**|User not found|No Content
|===


===== Produces

* `application/json`


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


===== Example HTTP response

====== Response 200
[source,json]
----
{
  "data": {
    "access_token": ""
  },
  "error": null,
  "success": true
}
----


[[_resetapikey]]
==== Reset API Key
....
POST /deepfence/v1.3/users/reset-api-key
....


===== Description
Permission: ALL


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Reset successful|No Content
|**400**|Bad request.|No Content
|**404**|User not found.|No Content
|===


===== Produces

* `application/json`


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_enumerate_resource]]
=== Enumerate

[[_dataapi]]
==== Data API
....
POST /deepfence/v1.3/data
....


===== Description
Get data of a previous request by status_id


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Body**|**Options** +
__optional__|Options|<<_options_1,Options_1>>
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


===== Example HTTP request

====== Request body
[source,json]
----
{
  "id" : "qwkfjwqfkwqkf"
}
----


[[_enumeratenodes]]
==== Enumerate API
....
POST /deepfence/v1.3/enumerate
....


===== Description
Enumerate nodes (hosts, containers, images, processes) with optional filters


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Body**|**Options** +
__optional__|Options to enumerate nodes|<<_options_2,Options_2>>
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


===== Example HTTP request

====== Request body
[source,json]
----
{
  "size" : 10,
  "start_index" : 0,
  "filters" : {
    "os" : [ "linux" ],
    "publicIpAddress" : [ "1.2.3.4" ],
    "pid" : 1225,
    "interfaceNames" : [ "lo", "docker0", "eth0" ],
    "type" : [ "host" ],
    "ppid" : 1225,
    "image_name" : [ "dev-1", "dev-2" ],
    "container_name" : [ "redis", "mysql" ],
    "kernel_version" : [ "4.13.0-1019-gcp #23-Ubuntu SMP Thu May 31 16:13:34 UTC 2018" ],
    "packet_capture" : [ "running" ],
    "pseudo" : [ false ],
    "host_name" : [ "dev-1", "dev-2" ],
    "local_networks" : [ "127.0.0.1/8", "172.17.0.1/16" ]
  }
}
----


[[_statusapi]]
==== Status API
....
POST /deepfence/v1.3/status
....


===== Description
Get status of a previous request by status_id


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Body**|**Options** +
__optional__|Options|<<_options_4,Options_4>>
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


===== Example HTTP request

====== Request body
[source,json]
----
{
  "id" : "qwkfjwqfkwqkf"
}
----


[[_node_control_resource]]
=== Node Control

[[_nodedetails]]
==== Node Details API
....
GET /deepfence/v1.3/node/{node_id}
....


===== Description
Get full details of a node (hosts, containers, images, processes) by node_id


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**node_id** +
__required__|Node ID (refer enumerate api)|string
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_startpacketcapture]]
==== Node Control - Start Packet Capture
....
POST /deepfence/v1.3/node/{node_id}/packet_capture_start
....


===== Description
Start Packet Capture on a node (Applicable node type - `host`)


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**node_id** +
__required__|Node ID (refer enumerate api)|string
|**Body**|**Options** +
__optional__|Options to start packet capture|<<_options_3,Options_3>>
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


===== Example HTTP request

====== Request body
[source,json]
----
{
  "snap_length" : 65535,
  "port_list" : [ 80, 8080, 8081 ],
  "interface_name" : "eth0",
  "capture_percentage" : 100
}
----


[[_packetcapturestatus]]
==== Node Control API - Packet Capture Status
....
GET /deepfence/v1.3/node/{node_id}/packet_capture_status
....


===== Description
Packet Capture Status for a node (Applicable node type - `host`)


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**node_id** +
__required__|Node ID (refer enumerate api)|string
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_stoppacketcapture]]
==== Node Control API - Stop Packet Capture
....
POST /deepfence/v1.3/node/{node_id}/packet_capture_stop
....


===== Description
Stop Packet Capture on a node (Applicable node type - `host`)


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**node_id** +
__required__|Node ID (refer enumerate api)|string
|**Body**|**Options** +
__optional__|Options (if applicable)|object
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_pausenode]]
==== Node Control API - Pause Node
....
POST /deepfence/v1.3/node/{node_id}/pause
....


===== Description
Pause a node (Applicable node type - `container`)


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**node_id** +
__required__|Node ID (refer enumerate api)|string
|**Body**|**Options** +
__optional__|Options (if applicable)|object
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_restartnode]]
==== Node Control API - Restart Node
....
POST /deepfence/v1.3/node/{node_id}/restart
....


===== Description
Restart a node (Applicable node type - `container`)


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**node_id** +
__required__|Node ID (refer enumerate api)|string
|**Body**|**Options** +
__optional__|Options (if applicable)|object
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_startnode]]
==== Node Control API - Start Node
....
POST /deepfence/v1.3/node/{node_id}/start
....


===== Description
Start a node (Applicable node type - `container`)


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**node_id** +
__required__|Node ID (refer enumerate api)|string
|**Body**|**Options** +
__optional__|Options (if applicable)|object
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_stopnode]]
==== Node Control API - Stop Node
....
POST /deepfence/v1.3/node/{node_id}/stop
....


===== Description
Stop a node (Applicable node type - `container`)


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**node_id** +
__required__|Node ID (refer enumerate api)|string
|**Body**|**Options** +
__optional__|Options (if applicable)|object
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_unpausenode]]
==== Node Control API - Unpause Node
....
POST /deepfence/v1.3/node/{node_id}/unpause
....


===== Description
Unpause a node (Applicable node type - `container`)


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**node_id** +
__required__|Node ID (refer enumerate api)|string
|**Body**|**Options** +
__optional__|Options (if applicable)|object
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_alert_management_resource]]
=== Alert Management

[[_findalerts]]
==== Get/Delete alerts by filter
....
POST /deepfence/v1.3/alerts
....


===== Description
Get/Delete alerts by filter


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Body**|**Options** +
__optional__|Options to get or delete alerts|<<_options,Options>>
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


===== Example HTTP request

====== Request body
[source,json]
----
{
  "size" : 10,
  "start_index" : 0,
  "detailed" : false,
  "action" : "get",
  "filters" : {
    "severity" : [ "critical" ],
    "anomaly" : [ "network_anomaly" ],
    "container_name" : [ "container-1", "container-2" ],
    "alert_id" : [ "ewqvfewqk", "ewokwlkevf" ],
    "resource_type" : [ "processes" ],
    "container_image" : [ "dev-1", "dev-2" ],
    "host_name" : [ "dev-1", "dev-2" ]
  }
}
----


[[_getalert]]
==== Get alert by given alert_id
....
GET /deepfence/v1.3/alerts/{alert_id}
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**alert_id** +
__required__|Alert ID|string
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_deletealert]]
==== Delete an alert by alert_id
....
DELETE /deepfence/v1.3/alerts/{alert_id}
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^4a"]
|===
|Type|Name|Schema
|**Path**|**alert_id** +
__required__|string
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**204**|Alert deleted successfully.|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_getnodeseverity]]
==== Get the severity of all nodes
....
GET /deepfence/v1.3/node-severities
....


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Valid response|No Content
|**400**|Bad request (like missing text data)|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_vulnerability_management_resource]]
=== Vulnerability Management

[[_startcve]]
==== Node Control API - Start CVE
....
POST /deepfence/v1.3/node/{node_id}/cve_scan_start
....


===== Description
Start CVE on a node (Applicable node type - `host`, `container`)


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**node_id** +
__required__|Node ID (refer enumerate api)|string
|**Body**|**Options** +
__optional__|Options (If applicable)|object
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_cvestatus]]
==== Node Control API - CVE Status
....
GET /deepfence/v1.3/node/{node_id}/cve_scan_status
....


===== Description
CVE Status for a node (Applicable node type - `host`, `container`)


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**node_id** +
__required__|Node ID (refer enumerate api)|string
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_stopcve]]
==== Node Control API - Stop CVE
....
POST /deepfence/v1.3/node/{node_id}/cve_scan_stop
....


===== Description
Stop CVE on a node (Applicable node type - `host`, `container`)


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**node_id** +
__required__|Node ID (refer enumerate api)|string
|**Body**|**Options** +
__optional__|Options (If applicable)|object
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_findvulnerability]]
==== Get/Delete vulnerabilities by filter
....
POST /deepfence/v1.3/vulnerability
....


===== Description
Get/Delete vulnerabilities by filter


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Body**|**Options** +
__optional__|Options to get or delete vulnerabilities|<<_options_7,Options_7>>
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


===== Example HTTP request

====== Request body
[source,json]
----
{
  "size" : 10,
  "start_index" : 0,
  "action" : "get",
  "filters" : {
    "cve_container_image_id" : [ "ewqlkfn" ],
    "cve_severity" : [ "critical" ],
    "container_name" : [ "container-1", "container-2" ],
    "vulnerability_id" : [ "ewqvfewqk", "ewokwlkevf" ],
    "cve_id" : [ "CVE-2018-9234" ],
    "cve_container_image" : [ "dev-1", "dev-2" ],
    "host_name" : [ "dev-1", "dev-2" ]
  }
}
----


[[_getvulnerability]]
==== Get vulnerability by given vulnerability_id
....
GET /deepfence/v1.3/vulnerability/{vulnerability_id}
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**vulnerability_id** +
__required__|Vulnerability ID|string
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_deletevulnerability]]
==== Delete a vulnerability doc by vulnerability_id
....
DELETE /deepfence/v1.3/vulnerability/{vulnerability_id}
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^4a"]
|===
|Type|Name|Schema
|**Path**|**vulnerability_id** +
__required__|string
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**204**|Vulnerability deleted successfully.|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_network_protection_policy_resource]]
=== Network Protection Policy

[[_getnetworkprotectionpolicy]]
==== Get all network policies created by the user.
....
GET /deepfence/v1.3/users/network_protection_policy
....


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Produces

* `application/json`


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_addnetworkprotectionpolicy]]
==== Add a network protection policy.
....
POST /deepfence/v1.3/users/network_protection_policy
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Body**|**body** +
__optional__|JSON parameters.|<<_body_1,body_1>>
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**201**|Policy added successfully.|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Produces

* `application/json`


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_deletenetworkprotectionpolicy]]
==== Delete a network policy
....
DELETE /deepfence/v1.3/users/network_protection_policy/{policy_id}
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^4a"]
|===
|Type|Name|Schema
|**Path**|**policy_id** +
__required__|integer
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**204**|Policy removed successfully.|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_network_protection_policy_logs_resource]]
=== Network Protection Policy Logs

[[_findnetworkprotectionpolicylogs]]
==== Get/Delete network protection policy logs by filter
....
POST /deepfence/v1.3/users/network_protection_policy_log
....


===== Description
Get/Delete network protection policy logs by filter


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Body**|**Options** +
__optional__|Options to get or delete policy logs|<<_options_5,Options_5>>
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Produces

* `application/json`


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


===== Example HTTP request

====== Request body
[source,json]
----
{
  "size" : 10,
  "start_index" : 0,
  "action" : "get",
  "filters" : {
    "severity" : [ "critical" ],
    "node_type" : [ "host" ],
    "policy_created_by" : [ "demo@deepfence.io" ],
    "alert_id" : [ "ewqvfewqk", "ewokwlkevf" ],
    "block_duration" : 3600,
    "action" : [ "block" ],
    "block_ip" : [ "111.222.333.444" ],
    "alert_count_threshold" : 1,
    "host_name" : [ "dev-1", "dev-2" ]
  }
}
----


[[_getnetworkprotectionpolicylog]]
==== Get network protection policy log by given policy_log_id
....
GET /deepfence/v1.3/users/network_protection_policy_log/{policy_log_id}
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**policy_log_id** +
__required__|Policy log ID|string
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Produces

* `application/json`


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_deletenetworkprotectionpolicylog]]
==== Delete network protection policy log by policy_log_id
....
DELETE /deepfence/v1.3/users/network_protection_policy_log/{policy_log_id}
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^4a"]
|===
|Type|Name|Schema
|**Path**|**policy_log_id** +
__required__|string
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**204**|Policy log deleted successfully.|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_quarantine_protection_policy_resource]]
=== Quarantine Protection Policy

[[_getquarantineprotectionpolicy]]
==== Get all quarantine policies created by the user.
....
GET /deepfence/v1.3/users/quarantine_protection_policy
....


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Produces

* `application/json`


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_addquarantineprotectionpolicy]]
==== Add a quarantine protection policy.
....
POST /deepfence/v1.3/users/quarantine_protection_policy
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Body**|**body** +
__optional__|JSON parameters.|<<_body_4,body_4>>
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**201**|Policy added successfully.|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Produces

* `application/json`


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_deletequarantineprotectionpolicy]]
==== Delete a quarantine policy
....
DELETE /deepfence/v1.3/users/quarantine_protection_policy/{policy_id}
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^4a"]
|===
|Type|Name|Schema
|**Path**|**policy_id** +
__required__|integer
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**204**|Policy removed successfully.|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_quarantine_protection_policy_logs_resource]]
=== Quarantine Protection Policy Logs

[[_findquarantineprotectionpolicylogs]]
==== Get/Delete quarantine protection policy logs by filter
....
POST /deepfence/v1.3/users/quarantine_protection_policy_log
....


===== Description
Get/Delete quarantine protection policy logs by filter


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Body**|**Options** +
__optional__|Options to get or delete policy logs|<<_options_6,Options_6>>
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Produces

* `application/json`


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


===== Example HTTP request

====== Request body
[source,json]
----
{
  "size" : 10,
  "start_index" : 0,
  "action" : "get",
  "filters" : {
    "severity" : [ "critical" ],
    "node_type" : [ "host" ],
    "policy_created_by" : [ "demo@deepfence.io" ],
    "alert_id" : [ "ewqvfewqk", "ewokwlkevf" ],
    "action" : [ "restart" ],
    "alert_count_threshold" : 1,
    "host_name" : [ "dev-1", "dev-2" ]
  }
}
----


[[_getquarantineprotectionpolicylog]]
==== Get quarantine protection policy log by given policy_log_id
....
GET /deepfence/v1.3/users/quarantine_protection_policy_log/{policy_log_id}
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Path**|**policy_log_id** +
__required__|Policy log ID|string
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Produces

* `application/json`


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_deletequarantineprotectionpolicylog]]
==== Delete quarantine protection policy log by policy_log_id
....
DELETE /deepfence/v1.3/users/quarantine_protection_policy_log/{policy_log_id}
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^4a"]
|===
|Type|Name|Schema
|**Path**|**policy_log_id** +
__required__|string
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**204**|Policy log deleted successfully.|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_workload_protection_policy_resource]]
=== Workload Protection Policy

[[_getworkloadprotectionpolicy]]
==== Get all node network protection policies created by the user.
....
GET /deepfence/v1.3/users/node_network_protection_policy
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Query**|**node_policy_type** +
__required__|Policy type - whitelist or blacklist|enum (blacklist, whitelist)
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Request success|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Produces

* `application/json`


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_addworkloadprotectionpolicy]]
==== Add a node network protection policy.
....
POST /deepfence/v1.3/users/node_network_protection_policy
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Body**|**body** +
__optional__|JSON parameters.|<<_body_2,body_2>>
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**201**|Policy added successfully.|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_bulkdeleteworkloadprotectionpolicy]]
==== Delete multiple node network protection policies
....
DELETE /deepfence/v1.3/users/node_network_protection_policy
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^9a,.^4a"]
|===
|Type|Name|Description|Schema
|**Body**|**body** +
__optional__|JSON parameters.|<<_body_3,body_3>>
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**200**|Policies deleted successfully.|No Content
|**400**|Bad request|No Content
|**401**|Unauthorized|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===


[[_deleteworkloadprotectionpolicy]]
==== Delete a node network protection policy
....
DELETE /deepfence/v1.3/users/node_network_protection_policy/{policy_id}
....


===== Parameters

[options="header", cols=".^2a,.^3a,.^4a"]
|===
|Type|Name|Schema
|**Path**|**policy_id** +
__required__|integer
|===


===== Responses

[options="header", cols=".^2a,.^14a,.^4a"]
|===
|HTTP Code|Description|Schema
|**204**|Policy removed successfully.|No Content
|**400**|Bad request.|No Content
|===


===== Security

[options="header", cols=".^3a,.^4a"]
|===
|Type|Name
|**apiKey**|**<<_bearer,Bearer>>**
|===




[[_definitions]]
== Definitions

[[_options]]
=== Options

[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**action** +
__optional__|Action to perform - `get` or `delete` +
**Default** : `"get"`|enum (get, delete)
|**detailed** +
__optional__|Detailed alert (includes all fields) or simple alert +
**Default** : `false`|boolean
|**filters** +
__optional__||<<_deepfencev1_3alerts_filters,deepfencev1.3alerts_filters>>
|**size** +
__optional__|The numbers of alerts to return +
**Minimum value** : `1` +
**Maximum value** : `10000` +
**Example** : `10`|integer
|**start_index** +
__optional__|The number of items to skip before starting to collect the result set +
**Minimum value** : `0` +
**Maximum value** : `9999` +
**Example** : `0`|integer
|===


[[_options_1]]
=== Options_1

[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**id** +
__optional__|Status ID which was sent in previous status api. If a particular request takes longer, api call will reply a status id. This id should be used to query the status of that particular request. It status is success, it will respond data url where data will be available. +
**Example** : `"qwkfjwqfkwqkf"`|string
|===


[[_options_2]]
=== Options_2

[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**filters** +
__optional__||<<_deepfencev1_3enumerate_filters,deepfencev1.3enumerate_filters>>
|**size** +
__optional__|The numbers of vulnerabilities to return +
**Minimum value** : `1` +
**Maximum value** : `100000` +
**Example** : `10`|integer
|**start_index** +
__optional__|The number of items to skip before starting to collect the result set +
**Minimum value** : `0` +
**Maximum value** : `99999` +
**Example** : `0`|integer
|===


[[_options_3]]
=== Options_3

[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**capture_percentage** +
__optional__|The percentage of traffic to capture +
**Minimum value** : `20` +
**Maximum value** : `100` +
**Example** : `100`|integer
|**interface_name** +
__optional__|The interface to start packet capture (refer node details api / enumerate api for available interfaces for a node). To start on all interfaces, use 'All' +
**Default** : `"All"` +
**Example** : `"eth0"`|string
|**port_list** +
__optional__|Ports to start packet capture +
**Example** : `[ 80, 8080, 8081 ]`|< integer > array
|**snap_length** +
__optional__|Packet header length +
**Minimum value** : `20` +
**Maximum value** : `65535` +
**Example** : `65535`|integer
|===


[[_options_4]]
=== Options_4

[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**id** +
__optional__|Status ID which was sent in previous request. If a particular request takes longer, api call will reply a status id. This id should be used to query the status of that particular request. It status is success, it will respond data url where data will be available. +
**Example** : `"qwkfjwqfkwqkf"`|string
|===


[[_options_5]]
=== Options_5

[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**action** +
__optional__|Action to perform - `get` or `delete` +
**Default** : `"get"`|enum (get, delete)
|**filters** +
__optional__||<<_deepfencev1_3usersnetwork_protection_policy_log_filters,deepfencev1.3usersnetwork_protection_policy_log_filters>>
|**size** +
__optional__|The numbers of policy logs to return +
**Minimum value** : `1` +
**Maximum value** : `10000` +
**Example** : `10`|integer
|**start_index** +
__optional__|The number of items to skip before starting to collect the result set +
**Minimum value** : `0` +
**Maximum value** : `9999` +
**Example** : `0`|integer
|===


[[_options_6]]
=== Options_6

[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**action** +
__optional__|Action to perform - `get` or `delete` +
**Default** : `"get"`|enum (get, delete)
|**filters** +
__optional__||<<_deepfencev1_3usersquarantine_protection_policy_log_filters,deepfencev1.3usersquarantine_protection_policy_log_filters>>
|**size** +
__optional__|The numbers of policy logs to return +
**Minimum value** : `1` +
**Maximum value** : `10000` +
**Example** : `10`|integer
|**start_index** +
__optional__|The number of items to skip before starting to collect the result set +
**Minimum value** : `0` +
**Maximum value** : `9999` +
**Example** : `0`|integer
|===


[[_options_7]]
=== Options_7

[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**action** +
__optional__|Action to perform - `get` or `delete` +
**Default** : `"get"`|enum (get, delete)
|**filters** +
__optional__||<<_deepfencev1_3vulnerability_filters,deepfencev1.3vulnerability_filters>>
|**size** +
__optional__|The numbers of vulnerabilities to return +
**Minimum value** : `1` +
**Maximum value** : `10000` +
**Example** : `10`|integer
|**start_index** +
__optional__|The number of items to skip before starting to collect the result set +
**Minimum value** : `0` +
**Maximum value** : `9999` +
**Example** : `0`|integer
|===


[[_body]]
=== body

[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**api_key** +
__optional__|api_key +
**Example** : `"qwjefwqkjfqkbvfq"`|string
|===


[[_body_1]]
=== body_1

[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**action** +
__optional__|action to take, when a policy is enforced +
**Default** : `"block"` +
**Example** : `"block"`|enum (block, ignore)
|**alert_count_threshold** +
__optional__|When number of alerts (threshold) is this, policy will be executed +
**Minimum value** : `1` +
**Maximum value** : `999999999` +
**Example** : `1`|integer
|**alert_from_time** +
__optional__|Only check in the past 'n' seconds, if ip address reached threshold +
**Minimum value** : `0` +
**Maximum value** : `999999999` +
**Example** : `0`|integer
|**alert_level** +
__optional__|Alert level +
**Example** : `"critical"`|enum (critical, high, medium, low)
|**block_duration** +
__optional__|Number of seconds to block the ip address +
**Minimum value** : `1` +
**Maximum value** : `999999999` +
**Example** : `3600`|integer
|**node_type** +
__optional__|Node type +
**Example** : `"host"`|enum (host)
|===


[[_body_2]]
=== body_2

[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**action** +
__optional__|action to take, when a policy is enforced +
**Example** : `"block"`|enum (block, unblock)
|**block_duration** +
__optional__|Number of seconds to block/allow the ip address +
**Minimum value** : `1` +
**Maximum value** : `999999999` +
**Example** : `3600`|integer
|**host_name** +
__optional__|Host name +
**Example** : `"dev-1"`|enum (inbound, outbound)
|**ip_address_list** +
__optional__|List of IP addresses +
**Example** : `[ "1.2.3.4" ]`|< string > array
|**node_policy_type** +
__optional__|Policy type - whitelist or blacklist +
**Example** : `"blacklist"`|enum (blacklist, whitelist)
|**packet_direction** +
__optional__|Packet direction - inbound or outbound +
**Example** : `"inbound"`|enum (inbound, outbound)
|**port_list** +
__optional__|List of ports +
**Example** : `[ "8080", "8081" ]`|< string > array
|===


[[_body_3]]
=== body_3

[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**policy_id_list** +
__optional__|List of policy ids +
**Example** : `[ 1, 3, 5 ]`|< integer > array
|===


[[_body_4]]
=== body_4

[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**action** +
__optional__|action to take, when a policy is enforced +
**Example** : `"pause"`|enum (pause, stop, restart)
|**alert_count_threshold** +
__optional__|When number of alerts (threshold) is this, policy will be executed +
**Minimum value** : `1` +
**Maximum value** : `999999999` +
**Example** : `1`|integer
|**alert_level** +
__optional__|Alert level +
**Example** : `"critical"`|enum (critical, high, medium, low)
|**node_type** +
__optional__|Node type +
**Example** : `"container"`|enum (container, host)
|===


[[_deepfencev1_3alerts_filters]]
=== deepfencev1.3alerts_filters
Filter alerts by various fields (key value pairs)


[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**alert_id** +
__optional__|Alert ids +
**Example** : `[ "ewqvfewqk", "ewokwlkevf" ]`|< string > array
|**anomaly** +
__optional__|Anomaly types +
**Example** : `[ "network_anomaly" ]`|< enum (network_anomaly, behavioral_anomaly, system_audit, syscall_anomaly) > array
|**container_image** +
__optional__|Container image names +
**Example** : `[ "dev-1", "dev-2" ]`|< string > array
|**container_name** +
__optional__|Container names +
**Example** : `[ "container-1", "container-2" ]`|< string > array
|**host_name** +
__optional__|Host names +
**Example** : `[ "dev-1", "dev-2" ]`|< string > array
|**resource_type** +
__optional__|Resource types +
**Example** : `[ "processes" ]`|< enum (processes, files, network) > array
|**severity** +
__optional__|Alert severity +
**Example** : `[ "critical" ]`|< enum (critical, high, medium, low) > array
|===


[[_deepfencev1_3enumerate_filters]]
=== deepfencev1.3enumerate_filters
Filter vulnerabilities by various fields (key value pairs)


[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**container_name** +
__optional__|Container name (for type `container`, `container_image`) +
**Example** : `[ "redis", "mysql" ]`|< string > array
|**host_name** +
__optional__|Host names +
**Example** : `[ "dev-1", "dev-2" ]`|< string > array
|**image_name** +
__optional__|Container image names (for type `container`, `container_image`) +
**Example** : `[ "dev-1", "dev-2" ]`|< string > array
|**interfaceNames** +
__optional__|Interface names (for type `host`) +
**Example** : `[ "lo", "docker0", "eth0" ]`|< string > array
|**kernel_version** +
__optional__|Kernel version (for type `host`) +
**Example** : `[ "4.13.0-1019-gcp #23-Ubuntu SMP Thu May 31 16:13:34 UTC 2018" ]`|< string > array
|**local_networks** +
__optional__|Local networks in CIDR format (for type `host`) +
**Example** : `[ "127.0.0.1/8", "172.17.0.1/16" ]`|< string > array
|**os** +
__optional__|Operating system (for type `host`) +
**Example** : `[ "linux" ]`|< string > array
|**packet_capture** +
__optional__|Packet capture state (for type `host`) +
**Example** : `[ "running" ]`|< enum (running, not_running) > array
|**pid** +
__optional__|Process ID (for type `process`) +
**Minimum value** : `1` +
**Example** : `1225`|integer
|**ppid** +
__optional__|Parent process ID (for type `process`) +
**Minimum value** : `1` +
**Example** : `1225`|integer
|**pseudo** +
__optional__|Pseudo node or not +
**Example** : `[ false ]`|< boolean > array
|**publicIpAddress** +
__optional__|Public IP of host (for type `host`) +
**Example** : `[ "1.2.3.4" ]`|< string > array
|**type** +
__optional__|Types of node +
**Example** : `[ "host" ]`|< enum (host, container, container_image, container_by_name, process, process_by_name) > array
|===


[[_deepfencev1_3usersnetwork_protection_policy_log_filters]]
=== deepfencev1.3usersnetwork_protection_policy_log_filters
Filter policy logs by various fields (key value pairs)


[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**action** +
__optional__|What policy action was performed +
**Example** : `[ "block" ]`|< enum (block, ignore) > array
|**alert_count_threshold** +
__optional__|Policy was executed when number of alerts (threshold) was this +
**Minimum value** : `1` +
**Maximum value** : `999999999` +
**Example** : `1`|integer
|**alert_id** +
__optional__|Alert id for which the policies got executed +
**Example** : `[ "ewqvfewqk", "ewokwlkevf" ]`|< string > array
|**block_duration** +
__optional__|Number of seconds ip address was blocked +
**Minimum value** : `1` +
**Maximum value** : `999999999` +
**Example** : `3600`|integer
|**block_ip** +
__optional__|IP address which got blocked or ignored +
**Example** : `[ "111.222.333.444" ]`|< string > array
|**host_name** +
__optional__|Host names +
**Example** : `[ "dev-1", "dev-2" ]`|< string > array
|**node_type** +
__optional__|Node type +
**Example** : `[ "host" ]`|< enum (host) > array
|**policy_created_by** +
__optional__|Email address of user who created this network protection policy +
**Example** : `[ "demo@deepfence.io" ]`|< string > array
|**severity** +
__optional__|Severity set in network protection policy +
**Example** : `[ "critical" ]`|< enum (critical, high, medium, low) > array
|===


[[_deepfencev1_3usersquarantine_protection_policy_log_filters]]
=== deepfencev1.3usersquarantine_protection_policy_log_filters
Filter policy logs by various fields (key value pairs)


[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**action** +
__optional__|What policy action was performed +
**Example** : `[ "restart" ]`|< enum (pause, stop, restart) > array
|**alert_count_threshold** +
__optional__|Policy was executed when number of alerts (threshold) was this +
**Minimum value** : `1` +
**Maximum value** : `999999999` +
**Example** : `1`|integer
|**alert_id** +
__optional__|Alert id for which the policies got executed +
**Example** : `[ "ewqvfewqk", "ewokwlkevf" ]`|< string > array
|**host_name** +
__optional__|Host names +
**Example** : `[ "dev-1", "dev-2" ]`|< string > array
|**node_type** +
__optional__|Node type +
**Example** : `[ "host" ]`|< enum (host, container) > array
|**policy_created_by** +
__optional__|Email address of user who created this quarantine protection policy +
**Example** : `[ "demo@deepfence.io" ]`|< string > array
|**severity** +
__optional__|Severity set in quarantine protection policy +
**Example** : `[ "critical" ]`|< enum (critical, high, medium, low) > array
|===


[[_deepfencev1_3vulnerability_filters]]
=== deepfencev1.3vulnerability_filters
Filter vulnerabilities by various fields (key value pairs)


[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**container_name** +
__optional__|Container names +
**Example** : `[ "container-1", "container-2" ]`|< string > array
|**cve_container_image** +
__optional__|Container image names +
**Example** : `[ "dev-1", "dev-2" ]`|< string > array
|**cve_container_image_id** +
__optional__|Container image ids +
**Example** : `[ "ewqlkfn" ]`|< string > array
|**cve_id** +
__optional__|CVE Id +
**Example** : `[ "CVE-2018-9234" ]`|< string > array
|**cve_severity** +
__optional__|CVE severity +
**Example** : `[ "critical" ]`|< enum (critical, high, medium, low) > array
|**host_name** +
__optional__|Host names +
**Example** : `[ "dev-1", "dev-2" ]`|< string > array
|**vulnerability_id** +
__optional__|Vulnerability ids +
**Example** : `[ "ewqvfewqk", "ewokwlkevf" ]`|< string > array
|===


[[_inline_response_200]]
=== inline_response_200

[options="header", cols=".^3a,.^11a,.^4a"]
|===
|Name|Description|Schema
|**data** +
__optional__|User details|object
|**error** +
__optional__|Error message, if any. Otherwise `null`|string
|**success** +
__optional__|Success status|boolean
|===




[[_securityscheme]]
== Security

[[_bearer]]
=== Bearer
[%hardbreaks]
__Type__ : access_token
__Name__ : Authorization
__In__ : HEADER



